# siae-auth 模块接口权限配置

> 注：超级管理员（ROLE_ROOT）默认放行所有接口，无需在权限表达式中声明

---

## AuthController - 认证管理

- **login** - 用户登录  
  权限：无（公开接口）

- **register** - 用户注册  
  权限：无（公开接口）

- **refreshToken** - 刷新访问令牌  
  权限：无（公开接口）

- **logout** - 用户登出  
  权限：无（需要携带有效token）

- **getCurrentUser** - 获取当前用户信息  
  权限：无（需要携带有效token）

---

## LogController - 日志管理

- **getLoginLogs** - 获取登录日志  
  权限：`hasAuthority('auth:log:query')`

- **getLoginFailLogs** - 获取登录失败日志  
  权限：`hasAuthority('auth:log:query')`

- **getDashboardStats** - 获取仪表盘统计数据  
  权限：`hasAuthority('auth:log:query')`

---

## PermissionController - 权限管理

- **createPermission** - 创建权限  
  权限：`hasAuthority('auth:permission:add')`

- **getPermissionsPage** - 分页查询权限列表  
  权限：`hasAuthority('auth:permission:query')`

- **getPermissionTree** - 查询权限树结构  
  权限：`hasAuthority('auth:permission:query')`

- **updatePermissionTree** - 批量更新权限树结构  
  权限：`hasAuthority('auth:permission:edit')`

- **getPermission** - 获取权限详情  
  权限：`hasAuthority('auth:permission:query')`

- **updatePermission** - 更新权限  
  权限：`hasAuthority('auth:permission:edit')`

- **deletePermission** - 删除权限  
  权限：`hasAuthority('auth:permission:delete')`

- **batchDeletePermissions** - 批量删除权限  
  权限：`hasAuthority('auth:permission:delete')`

---

## RoleController - 角色管理

- **createRole** - 创建角色  
  权限：`hasAuthority('auth:role:add')`

- **updateRole** - 更新角色  
  权限：`hasAuthority('auth:role:edit')`

- **deleteRole** - 删除角色  
  权限：`hasAuthority('auth:role:delete')`

- **batchDeleteRoles** - 批量删除角色  
  权限：`hasAuthority('auth:role:delete')`

- **getRolesPage** - 分页查询角色列表  
  权限：`hasAuthority('auth:role:query')`

- **getRoles** - 获取所有角色  
  权限：`hasAuthority('auth:role:query')`

- **getRole** - 获取指定角色  
  权限：`hasAuthority('auth:role:query')`

- **getPermissionsByRoleId** - 获取角色权限列表  
  权限：`hasAuthority('auth:permission:query')`

- **updateRolePermissions** - 更新角色权限  
  权限：`hasAuthority('auth:role:edit')`

- **assignPermissions** - 追加角色权限  
  权限：`hasAuthority('auth:role:edit')`

---

## UserPermissionController - 用户权限管理

- **getUserPermissions** - 分页查询用户权限  
  权限：`hasAuthority('auth:user:permission:query')`

- **assignPermissions** - 分配用户权限（覆盖模式）  
  权限：`hasAuthority('auth:user:permission:assign')`

- **appendPermissions** - 追加用户权限（增量模式）  
  权限：`hasAuthority('auth:user:permission:assign')`

- **removeAllPermissions** - 移除用户所有权限  
  权限：`hasAuthority('auth:user:permission:remove')`

- **removePermissions** - 移除用户指定权限  
  权限：`hasAuthority('auth:user:permission:remove')`

---

## UserRoleController - 用户角色管理

- **assignUserRoles** - 为用户分配单个角色  
  权限：`hasAuthority('auth:user:role:assign')`

- **batchAssignRoleToUsers** - 批量分配角色给用户  
  权限：`hasAuthority('auth:user:role:assign')`

- **getUserRoleList** - 获取用户角色关联列表  
  权限：`hasAuthority('auth:user:role:query')`

- **updateUserRole** - 更新用户角色关联  
  权限：`hasAuthority('auth:user:role:update')`

---

## 权限常量说明

### 角色管理权限
- `auth:role:query` - 查询角色
- `auth:role:add` - 新增角色
- `auth:role:edit` - 修改角色
- `auth:role:delete` - 删除角色

### 权限管理权限
- `auth:permission:query` - 查询权限
- `auth:permission:add` - 新增权限
- `auth:permission:edit` - 修改权限
- `auth:permission:delete` - 删除权限

### 日志管理权限
- `auth:log:query` - 查询登录日志
- `auth:log:export` - 导出登录日志

### 用户角色关联权限
- `auth:user:role:assign` - 分配用户角色
- `auth:user:role:query` - 查询用户角色
- `auth:user:role:update` - 更新用户角色
- `auth:user:role:remove` - 移除用户角色

### 用户权限关联权限
- `auth:user:permission:assign` - 分配用户权限
- `auth:user:permission:query` - 查询用户权限
- `auth:user:permission:remove` - 移除用户权限

### 使用示例
```java
// 单个权限
@SiaeAuthorize("hasAuthority('auth:role:query')")
@SiaeAuthorize("hasAuthority('auth:permission:add')")

// 权限常量引用
import static com.hngy.siae.core.permissions.AuthPermissions.*;

@SiaeAuthorize("hasAuthority('" + AUTH_ROLE_QUERY + "')")
@SiaeAuthorize("hasAuthority('" + AUTH_PERMISSION_ADD + "')")
```

---

## 接口统计

### 按 Controller 统计
- **AuthController**: 5个接口（全部公开或需token）
- **LogController**: 3个接口（全部需要日志查询权限）
- **PermissionController**: 8个接口（需要权限管理相关权限）
- **RoleController**: 10个接口（需要角色管理相关权限）
- **UserPermissionController**: 5个接口（需要用户权限管理相关权限）
- **UserRoleController**: 4个接口（需要用户角色管理相关权限）

**总计**: 35个接口

### 按权限类型统计
- **公开接口**: 5个（登录、注册、刷新令牌、登出、获取当前用户）
- **角色管理**: 10个接口
- **权限管理**: 8个接口
- **日志管理**: 3个接口
- **用户角色管理**: 4个接口
- **用户权限管理**: 5个接口
