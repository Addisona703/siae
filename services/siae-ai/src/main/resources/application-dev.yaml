# ===================================================================
# DEVELOPMENT CONFIGURATION
# Location: siae-ai/src/main/resources/application-dev.yaml
# ===================================================================

server:
  port: 8060
  servlet:
    context-path: /api/v1/ai

spring:
  application:
    name: siae-ai
  
  # 排除 Spring Security 自动配置（开发环境）
  autoconfigure:
    exclude:
      - org.springframework.boot.autoconfigure.security.servlet.SecurityAutoConfiguration
      - org.springframework.boot.actuate.autoconfigure.security.servlet.ManagementWebSecurityAutoConfiguration
  
  # AI Configuration - 保留 Spring AI 配置用于兼容
  ai:
    ollama:
      base-url: ${OLLAMA_BASE_URL:http://localhost:11434}
      chat:
        options:
          model: ${QWEN_MODEL:qwen3:8b}
          temperature: 0.3
          num-predict: 4000
    deepseek:
      enabled: false  # 禁用 DeepSeek 自动配置

  # Redis Configuration (保留用于其他服务，AI 服务不再使用)
  data:
    redis:
      host: localhost
      port: 6379
      password: 123456
      database: 0

  # MySQL Configuration
  datasource:
    driver-class-name: com.mysql.cj.jdbc.Driver
    url: jdbc:mysql://localhost:3306/ai_db?useUnicode=true&characterEncoding=utf8&serverTimezone=Asia/Shanghai&useSSL=false&allowPublicKeyRetrieval=true
    username: root
    password: 123456
    type: com.alibaba.druid.pool.DruidDataSource
    druid:
      initial-size: 1
      min-idle: 1
      max-active: 3
      max-wait: 60000

  # Cloud Configuration
  cloud:
    nacos:
      discovery:
        enabled: true
        server-addr: localhost:8848
        namespace: public

# MyBatis-Plus Configuration
mybatis-plus:
  mapper-locations: classpath*:/mapper/**/*.xml
  configuration:
    map-underscore-to-camel-case: true
    log-impl: org.apache.ibatis.logging.stdout.StdOutImpl

# ===================================================================
# Custom AI Properties - 多供应商配置
# Requirements: 1.1, 1.2, 1.3, 8.2, 8.3
# ===================================================================
siae:
  ai:
    # 默认供应商
    default-provider: zhipu
    
    # 供应商配置
    providers:
      # 智谱 AI 配置（默认供应商）
      zhipu:
        api-key: 6366b796dd414bb59ea66da25c4f6116.qf9ecpuPaVp2kC6B
        base-url: https://open.bigmodel.cn/api/paas/v4
        display-name: 智谱AI
        models:
          - glm-4-flash        # 免费模型
          - glm-4.5-flash      # 免费模型
          - glm-4.5-air
          - glm-4.1v-thinking-flashx
          - glm-4.6
          - glm-4.6v
          - cogvideox-3
          - cogview-4-250304
        default-model: glm-4-flash
      
      # OpenAI 配置（可选）
      openai:
        api-key: ${OPENAI_API_KEY:}
        base-url: https://api.openai.com/v1
        display-name: OpenAI
        models:
          - gpt-3.5-turbo
          - gpt-4
          - gpt-4-turbo
        default-model: gpt-3.5-turbo
      
      # DeepSeek 配置（可选）
      deepseek:
        api-key: ${DEEPSEEK_API_KEY:}
        base-url: https://api.deepseek.com/v1
        display-name: DeepSeek
        models:
          - deepseek-chat
          - deepseek-coder
        default-model: deepseek-chat
    
    # 聊天参数配置
    chat:
      temperature: 0.7
      max-tokens: 2000
      response-timeout: 60
      system-prompt: >
        您是SIAE（学生创新与创业协会）的智能助手，致力于为协会成员和访客提供高效、专业的信息查询和支持服务。
        您将通过智能交互为用户提供各种协会相关数据、统计信息、资源推荐等内容。
        您能回答关于协会成员、奖项、活动内容、热门资源等方面的问题。
        回答应专业，避免重复用户问题。所有回答必须使用Markdown格式，并保持格式一致性。
    
    # 会话配置
    session:
      max-messages: 20
  
  # Auth Properties (开发环境禁用网关认证)
  auth:
    enable-gateway-auth: true
    enable-direct-access: false
  security:
    enabled: true
    permission:
      redis-enabled: true

# Logging
logging:
  level:
    com.hngy.siae.ai: DEBUG
    org.springframework.ai: TRACE
    org.springframework.ai.openai: TRACE

# SpringDoc OpenAPI
springdoc:
  api-docs:
    path: /v3/api-docs
  swagger-ui:
    path: /swagger-ui.html
